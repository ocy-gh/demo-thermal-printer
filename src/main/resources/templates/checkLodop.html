<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html lang="en">

<head>
    <meta charset="UTF-8">

    <!-- C-LODOP -->
    <script src='http://localhost:8000/CLodopfuncs.js?name=CLODOPA'></script>
    <script src='http://192.168.3.18:8000/CLodopfuncs.js'></script>

    <!-- LODOP -->
    <script src='/js/LodopFunc.js'></script>

    <object  id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
        <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0></embed>
    </object>
</head>
    <body onload="CheckIsInstall()">
        <p id="txtPrint">Thermal Printer Test-Print</p>

        <p> </p>

        <h4 id="txtInstall">Lodop is not installed/activated, Hit Here to
            <a href="http://www.lodop.net/download/Lodop6.226_Clodop3.093.zip">
                Download
            </a>
            <br>（To Activate, Hit Here to
            <a href="CLodop.protocol:setup" target="_self">
                Re-activate
            </a>），Refresh page after installed/activated Lodop.
        </h4>
    </body>
</html>

<script>
    var txtInstall = document.getElementById("txtInstall");
    txtInstall.style.display = "none";

    function CheckIsInstall() {
        try{
            var LODOP = getLodop(document.getElementById('LODOP_OB'), document.getElementById('LODOP_EM'));
            if ((LODOP != null) && (typeof (LODOP.VERSION) != "undefined")) {
                if (CLODOP.CVERSION) {
                    alert("C-Lodop Available!\n C-Lodop Version:"+CLODOP.CVERSION+"(Including Lodop with Version"+LODOP.VERSION+")");

                } else {
                    alert("Lodop Installed！\n Version:"+LODOP.VERSION);
                }
            } else {
                alert("LODOP IS NULL OR VERSION UNDEFINED");
                txtInstall.style.display = "block";
            }
        } catch(err) {
            alert("Error!");
            txtInstall.style.display = "block";
        }
    }
</script>

